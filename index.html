<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>La Plaza</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="49.jpeg">

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#355e3b">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif;}
body{background:#f4f7fb;}

header{
  background:#355e3b;
  color:#fff;
  padding:18px;
  text-align:center;
  font-weight:600;
}

.hero{
  background: url('31.jpeg') no-repeat center center;
  background-size: cover;
  color: #fff;
  margin: 16px;
  padding: 25px;
  border-radius: 25px;
  text-align: center;
}
.section{
  background:#fff;
  margin:16px;
  padding:20px;
  border-radius:20px;
  box-shadow:0 6px 18px rgba(0,0,0,.05);
}

.btnPrincipal{
  padding:12px 20px;
  background:#355e3b;
  color:white;
  border:none;
  border-radius:12px;
  cursor:pointer;
  font-weight:600;
}

.status{font-weight:bold;font-size:18px;}

.progress{
  width:100%;
  background:#ddd;
  border-radius:20px;
  overflow:hidden;
  margin-top:10px;
}

.progress-bar{
  height:12px;
  width:0%;
  background:#355e3b;
  transition:width 1s ease;
}

footer{
  text-align:center;
  padding:20px;
  font-size:14px;
  color:#666;
}

/* MODAL APP STYLE */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  backdrop-filter:blur(5px);
  justify-content:center;
  align-items:flex-end;
  z-index:1000;
}

.modalContent{
  background:rgba(255,255,255,.95);
  width:100%;
  max-height:90vh;
  border-top-left-radius:25px;
  border-top-right-radius:25px;
  padding:20px;
  overflow-y:auto;
  animation:slideUp .35s ease;
}

@keyframes slideUp{
  from{transform:translateY(100%)}
  to{transform:translateY(0)}
}
/* ====== BARRA INFERIOR FIJA ABAJO ====== */

.bottomNav{
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 70px;
  background: #ffffff;
  display: flex;
  justify-content: space-around;
  align-items: center;
  border-top: 1px solid #eee;
  box-shadow: 0 -4px 15px rgba(0,0,0,.08);
  z-index: 999;
}

.bottomNav a{
  text-decoration: none;
  color: inherit;
  flex:1;
  text-align:center;
}

.navItem{
  display: flex;
  flex-direction: column;
  align-items: center;
  font-size: 11px;
  color: #888;
  transition: .3s;
  position:relative;
}

.icon{
  width: 24px;
  height: 24px;
  fill: currentColor;
  margin-bottom:4px;
}

/* ACTIVO */
.navItem.active{
  color: #355e3b;
  font-weight:600;
}

.navItem.active::before{
  content:"";
  position:absolute;
  top:-8px;
  width:30px;
  height:4px;
  background:#355e3b;
  border-radius:10px;
}

/* EFECTO TOQUE */
.navItem:active{
  transform: scale(.85);
}

.modalHeader{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}

.cerrar{
  font-size:20px;
  cursor:pointer;
}

input,select{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #ccc;
  margin-top:10px;
}

/* --- MODAL GENERAL --- */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.6);
  backdrop-filter:blur(5px);
  justify-content:center;
  align-items:flex-end; /* üî• LO PEGA ABAJO */
  z-index:1000;
  cursor:pointer;
}
.modalContent{
  animation:slideUp .35s ease;
}
/* --- MODAL CENTRADO PARA 1 Y 2 --- */
.modalContent.centerModal{
  background:linear-gradient(180deg, #1e3a8a, #14285f);
  border-radius:25px;
  padding:30px 25px;
  max-width:90%;
  width:380px;
  text-align:center;
  box-shadow:0 15px 35px rgba(0,0,0,0.3);
  border: 2px solid #cecece;
  position: relative;
}

.fancyModal h1, .fancyModal h2{
  color:#ffffff;
  margin-bottom:15px;
  text-shadow: 1px 1px 5px rgba(0,0,0,0.2);
}

.fancyModal p{
  color:#ffffff;
  font-size:15px;
  line-height:1.5;
  margin-bottom:20px;
}

.modalImg{
  width:200px;
  border-radius:20px;
  margin:15px 0;
  box-shadow:0 8px 20px rgba(0,0,0,0.2);
  transition: transform 0.4s ease;
}

.modalImg:hover{
  transform: scale(1.05) rotate(-2deg);
}

/* --- MODAL 3 IMAGEN --- */
.modalContent.centerModal.modalImagen{
  background: transparent;
  padding:0;
  max-width:90%;
  max-height:90%;
}

.modalSoloImagen{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
  border-radius:20px;
  transition: transform 0.3s ease;
}

.modalSoloImagen:hover{
  transform: scale(1.03);
}

/* Bot√≥n de cerrar Modal 3 */
.btnCerrar{
  position:absolute;
  top:10px;
  right:10px;
  background:rgba(0,0,0,0.5);
  color:#fff;
  border:none;
  border-radius:50%;
  width:35px;
  height:35px;
  font-size:18px;
  cursor:pointer;
  z-index:10;
  display:flex;
  align-items:center;
  justify-content:center;
  transition: background 0.2s;
}

.btnCerrar:hover{
  background:rgba(0,0,0,0.8);
}

/* --- BOTONES PRINCIPALES --- */
.btnPrincipal{
  padding:12px 25px;
  font-weight:700;
  background:#a4a4a4;
  color:#fff;
  border:none;
  border-radius:15px;
  cursor:pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}

.btnPrincipal:hover{
  transform: scale(1.05);
  box-shadow: 0 8px 15px rgba(0,0,0,0.25);
}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
  margin-top:15px;
}

.card{
  background:#f8f8f8;
  padding:14px;
  border-radius:16px;
  text-align:center;
  box-shadow:0 4px 12px rgba(0,0,0,.05);
  transition:.3s;
}

.card:hover{
  transform:translateY(-4px);
}

.foto{
  width:60px;
  height:60px;
  border-radius:50%;
  object-fit:cover;
  margin-bottom:8px;
}

.nombre{
  font-weight:600;
  color:#355e3b;
  font-size:14px;
}

.oferta{
  font-size:12px;
  color:#555;
  margin-top:4px;
}

.whatsapp{
  margin-top:8px;
  display:inline-block;
  padding:5px 10px;
  background:#25D366;
  color:#fff;
  border-radius:8px;
  font-size:11px;
  text-decoration:none;
}

/* =========================
   ESTILOS RESPONSIVOS
========================= */
@media(min-width: 768px){ 
  .hero{
    margin: 40px auto;
    padding: 60px;
    border-radius: 30px;
    max-width: 1000px;
  }
  .section{
    margin: 20px auto;
    padding: 30px;
    max-width: 1000px;
    border-radius: 25px;
  }
  .grid{
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-top: 20px;
  }
  .btnPrincipal{
    padding: 15px 25px;
    font-size: 16px;
  }
  footer{
    font-size: 16px;
  }
}

@media(min-width: 1200px){
  .grid{
    grid-template-columns: repeat(4, 1fr);
  }
  .hero{
    max-width: 1200px;
  }
  .section{
    max-width: 1200px;
  }
}
</style>
</head>

<body>
<header>Mercado Artesan√≠as Somoto</header>

<div class="hero">
  <h2>Impulsando la Econom√≠a Local</h2>
  <p id="estadoHorario"></p>

  <button id="btnInstalar" class="btnPrincipal" style="display:none;margin-top:15px;">
    üì≤ Instalar App
  </button>
</div>

<div class="section">
<h3>‚è∞ Horario</h3>
<p><strong>8:30 AM - 5:00 PM</strong></p>
<p id="estado" class="status"></p>
</div>

<div class="section">
<h3>üìä Ocupaci√≥n</h3>
<p id="ocupacionTexto"></p>
<div class="progress">
<div class="progress-bar" id="barraOcupacion"></div>
</div>
</div>

<div class="section" style="text-align:center;">
<h3>üõçÔ∏è Emprendedores</h3>
<button class="btnPrincipal" onclick="abrirModal()">Ver Emprendedores</button>
</div>

<!-- MAPA INTERACTIVO -->
<!-- MAPA INTERACTIVO -->
<div class="section">
  <h3>üó∫Ô∏è Ubicaci√≥n del Mercado</h3>
  <div style="width:100%;height:400px;border-radius:15px;overflow:hidden;">
    <iframe 
      src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3879.8977310995438!2d-86.58709407408537!3d13.480398986883726!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8f71dfd418c35cf1%3A0xd9c448e31dc9f1!2sMercado%20de%20Artesan%C3%ADas%20de%20Madriz!5e0!3m2!1ses-419!2sni!4v1771965117928!5m2!1ses-419!2sni" 
      width="100%" 
      height="100%" 
      style="border:0;" 
      allowfullscreen="" 
      loading="lazy" 
      referrerpolicy="no-referrer-when-downgrade">
    </iframe>
  </div>
</div>
<footer>
Plataforma digital cultural ‚Äì Somoto, Madriz ‚Äì Nicaragua
</footer>

<!-- MODAL -->
<div id="modal" class="modal">
  <div class="modalContent">
    <div class="modalHeader">
      <h3>Emprendedores</h3>
      <span class="cerrar" onclick="cerrarModal()">‚úñ</span>
    </div>

    <input type="text" id="buscador" placeholder="Buscar...">
    <select id="filtro">
      <option value="todos">Todas las categor√≠as</option>
      <option value="Textiles">Textiles</option>
      <option value="Gastronom√≠a">Gastronom√≠a</option>
      <option value="Cer√°mica">Cer√°mica</option>
      <option value="Cuero">Cuero</option>
    </select>

    <div id="lista" class="grid"></div>

  </div>
</div>
<!-- MODAL 1 ‚Äì BIENVENIDA IMPACTANTE -->
<div id="modalBienvenida" class="modal">
  <div class="modalContent centerModal fancyModal">
    <h1>üéâ ¬°Bienvenido!</h1>
    <p>Esta app est√° creada para dar a conocer a los emprendedores del Mercado de Artesan√≠as y mostrar un poco m√°s de la cultura nicarag√ºense.</p>
    <img src="31.jpeg" alt="Mercado" class="modalImg">
    <button class="btnPrincipal" onclick="cerrarBienvenida()">¬°Explorar!</button>
  </div>
</div>

<!-- MODAL 2 ‚Äì INFORMACI√ìN R√ÅPIDA -->
<div id="modalInfo" class="modal">
  <div class="modalContent centerModal fancyModal">
    <h2>Disfruta de la Cultura Nicaraguense</h2>
    <button class="btnPrincipal" onclick="cerrarInfo()">¬°Entendido!</button>
  </div>
</div>

<!-- MODAL 3 ‚Äì IMAGEN CENTRADA CON BOT√ìN DE CERRAR -->
<div id="modalImagen" class="modal">
  <div class="modalContent centerModal fancyModal">
    <button class="btnCerrar" onclick="cerrarModalImagen()">‚úñ</button>
    <img src="47.jpeg" alt="Imagen Especial" class="modalSoloImagen">
  </div>
</div>
<!-- BARRA INFERIOR -->
<nav class="bottomNav">

  <a href="index.html" class="navItem">
    <svg viewBox="0 0 24 24" class="icon">
      <path d="M3 12l9-9 9 9v9a2 2 0 0 1-2 2h-4v-6H9v6H5a2 2 0 0 1-2-2z"/>
    </svg>
    <small>Inicio</small>
  </a>

  <a href="emprendedores.html" class="navItem active">
    <svg viewBox="0 0 24 24" class="icon">
      <path d="M6 2l3 6h6l3-6H6zm-3 8h18l-1.5 10a2 2 0 0 1-2 2H6.5a2 2 0 0 1-2-2L3 10z"/>
    </svg>
    <small>Emprendedores</small>
  </a>

  <a href="historia.html" class="navItem">
    <svg viewBox="0 0 24 24" class="icon">
      <path d="M12 2l7 4v16l-7-4-7 4V6z"/>
    </svg>
    <small>Historia</small>
  </a>

</nav>

<!-- Leaflet CSS y JS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>/* =========================
   CONFIGURACI√ìN GENERAL
========================= */
const TOTAL_LOCALES = 16;
const LOCALES_OCUPADOS = 14;

const emprendedores = [
{nombre:"YOLUVAMI",ofrece:"Lubricantes y aceites",categoria:"Lubricantes",telefono:"50588880001",foto:"23.jpeg"},
{nombre:"Creaciones Mary",ofrece:"Todo tipo de artesan√≠a",categoria:"Artesan√≠a",telefono:"50585163627",foto:"12.jpeg"},
{nombre:"Galeria Alvaro",ofrece:"Cuadros,manualidades",categoria:"Pintura",telefono:"50557674926",foto:"38.jpeg"},
{nombre:"Creaciones la Moda",ofrece:"costura",categoria:"Costura",telefono:"50558320825",foto:"35.jpeg"},
{nombre:"J_BARBER",ofrece:"Cortes de pelo",categoria:"Barberia",telefono:"50576837733",foto:"33.jpeg"},
{nombre:"CAFETIN OMARIT",ofrece:"Comida",categoria:"Gastronom√≠a",telefono:"505",foto:"59.jpeg"}
];

const $ = id => document.getElementById(id);

/* =========================
   MODAL SECUENCIA
========================= */
function cerrarBienvenida(){
  $("modalBienvenida").style.display='none';
  setTimeout(()=> $("modalInfo").style.display='flex', 300);
}

function cerrarInfo(){
  $("modalInfo").style.display='none';
  setTimeout(()=> abrirModalImagen(), 300);
}

function abrirModalImagen(){
  $("modalImagen").style.display='flex';
}

function cerrarModalImagen(){
  $("modalImagen").style.display='none';
  localStorage.setItem('modalesUltimaVez', Date.now());
}

window.addEventListener('load', ()=>{
  const ahora = Date.now();
  const ultimaVez = localStorage.getItem('modalesUltimaVez');
  const diezMinutos = 10 * 60 * 1000;

  if(!ultimaVez || (ahora - ultimaVez) > diezMinutos){
    $("modalBienvenida").style.display='flex';
  }
});

/* =========================
   EMPRENDEDORES
========================= */
function generarCategorias(){
  const categoriasUnicas = [...new Set(emprendedores.map(e => e.categoria))];
  const select = $("filtro");
  select.innerHTML = `<option value="todos">Todas</option>`;
  categoriasUnicas.forEach(cat=>{
    const option = document.createElement("option");
    option.value = cat;
    option.textContent = cat;
    select.appendChild(option);
  });
}

function abrirModal(){
  $("modal").style.display="flex";
  mostrar();
}

function cerrarModal(){
  $("modal").style.display="none";
}

function mostrar(){
  const texto = $("buscador").value.toLowerCase();
  const filtro = $("filtro").value;
  $("lista").innerHTML="";

  const filtrados = emprendedores.filter(e =>
    (e.nombre.toLowerCase().includes(texto) ||
     e.ofrece.toLowerCase().includes(texto)) &&
    (filtro==="todos" || e.categoria===filtro)
  );

  filtrados.forEach(emp=>{
    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`
      <img src="${emp.foto}" class="foto">
      <div class="nombre">${emp.nombre}</div>
      <div class="oferta">${emp.ofrece}</div>
      <a class="whatsapp" target="_blank"
      href="https://wa.me/${emp.telefono}">
      WhatsApp
      </a>`;
    $("lista").appendChild(div);
  });
}

/* =========================
   OCUPACI√ìN
========================= */
function actualizarOcupacion(){
  const porcentaje = Math.round((LOCALES_OCUPADOS / TOTAL_LOCALES) * 100);
  $("ocupacionTexto").innerText =
    `${LOCALES_OCUPADOS} de ${TOTAL_LOCALES} locales ocupados (${porcentaje}%)`;
  $("barraOcupacion").style.width = porcentaje + "%";
}

/* =========================
   HORARIO
========================= */
function verificarHorario(){
  const ahora = new Date();
  const totalMin = ahora.getHours()*60 + ahora.getMinutes();
  const apertura = 8*60 + 30;
  const cierre = 17*60;
  const horaFormateada =
    ahora.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});

  if(totalMin >= apertura && totalMin < cierre){
    $("estado").innerHTML="üü¢ ABIERTO";
    $("estadoHorario").innerHTML="Abierto ahora ‚Ä¢ " + horaFormateada;
  }else{
    $("estado").innerHTML="üî¥ CERRADO";
    $("estadoHorario").innerHTML="Cerrado ahora ‚Ä¢ " + horaFormateada;
  }
}

/* =========================
   PWA INSTALACI√ìN
========================= */
let deferredPrompt;
const btnInstalar = $("btnInstalar");

window.addEventListener("beforeinstallprompt", (e)=>{
  e.preventDefault();
  deferredPrompt = e;
  btnInstalar.style.display="inline-block";
});

btnInstalar.addEventListener("click", async ()=>{
  if(deferredPrompt){
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt = null;
    btnInstalar.style.display="none";
  }
});

/* =========================
   SERVICE WORKER
========================= */
if("serviceWorker" in navigator){
  navigator.serviceWorker.register("sw.js");
}

/* =========================
   INICIALIZAR
========================= */
generarCategorias();
mostrar();
actualizarOcupacion();
verificarHorario();
setInterval(verificarHorario,60000);
</script>

</body>
</html>